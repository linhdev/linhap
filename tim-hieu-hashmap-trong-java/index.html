
<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta http-equiv="Cache-Control" content="public" />
 
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.89.4" />

    
    
    

<title>HashMap Knowledge in Java • Linhap</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="HashMap Knowledge in Java"/>
<meta name="twitter:description" content="Những thứ cần biết về hashmap Hôm nay là một ngày cuối tuần không phải OT, cũng giống như nhưng buổi tuần trước đó thường sẽ ngủ một giấc tới lúc hoàng hôn mới dậy(đấy là mình nghĩ thế thôi). Chả là hôm trước ở công ty thấy các bạn tts ở công ty mình đang được anh Lead đứng lớp java core đang học đến phần Collections: List, Vector, LinkedList, Set&hellip; có phần riêng biệt đó là Map trong java."/>

<meta property="og:title" content="HashMap Knowledge in Java" />
<meta property="og:description" content="Những thứ cần biết về hashmap Hôm nay là một ngày cuối tuần không phải OT, cũng giống như nhưng buổi tuần trước đó thường sẽ ngủ một giấc tới lúc hoàng hôn mới dậy(đấy là mình nghĩ thế thôi). Chả là hôm trước ở công ty thấy các bạn tts ở công ty mình đang được anh Lead đứng lớp java core đang học đến phần Collections: List, Vector, LinkedList, Set&hellip; có phần riêng biệt đó là Map trong java." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://linhdev.github.io/tim-hieu-hashmap-trong-java/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-04T11:39:16+02:00" />
<meta property="article:modified_time" content="2021-12-04T11:39:16+02:00" /><meta property="og:site_name" content="Linhap" />




<link rel="canonical" href="https://linhdev.github.io/tim-hieu-hashmap-trong-java/" />

<link rel="shortcut icon" href="https://scontent.fhan14-2.fna.fbcdn.net/v/t1.6435-9/72691417_2382776388627811_9048529879649222656_n.jpg?_nc_cat=100&amp;ccb=1-5&amp;_nc_sid=09cbfe&amp;_nc_ohc=xjFRyT3cuEQAX9ilgdS&amp;_nc_ht=scontent.fhan14-2.fna&amp;oh=8efbf281fe00c7b0a87bee862589f821&amp;oe=61D1C38E" type="image/x-icon">
<link rel="icon" href="https://scontent.fhan14-2.fna.fbcdn.net/v/t1.6435-9/72691417_2382776388627811_9048529879649222656_n.jpg?_nc_cat=100&amp;ccb=1-5&amp;_nc_sid=09cbfe&amp;_nc_ohc=xjFRyT3cuEQAX9ilgdS&amp;_nc_ht=scontent.fhan14-2.fna&amp;oh=8efbf281fe00c7b0a87bee862589f821&amp;oe=61D1C38E" type="image/x-icon">





<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">

<link rel="stylesheet" href="/css/w3.css" />


<link rel="stylesheet" href="/css/style.css" />









  
  
</head>
<body class="w3-light-grey">


    
    <header id="header">
         
        <div class="w3-right ">
<div class="w3-bar w3-light-grey  ">
  
  <span class="w3-bar-item w3-left " id="google_translate_element"></span>
<script>
  function googleTranslateElementInit() {
    new google.translate.TranslateElement(
      {
          pageLanguage: 'en'
        , layout: google.translate.TranslateElement.FloatPosition.TOP_RIGHT
        , multilanguagePage: true
      }
      , 'google_translate_element'
    );
  }
</script>
<script async src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>


  
       <a href="javascript:void(0)" class="w3-bar-item w3-button w3-hover-green" title="Search" onclick="displaysearch()"><i class="fa fa-search"></i></a>
  
      <span class="w3-hide-small">
        
        <a href="https://linhdev.github.io/" class="w3-bar-item w3-button w3-hover-green"><i class="fa fa-github"></i></a>

      </span>
  
</div>
</div>
<br>
  <div class="w3-content">
  
  <div class="w3-container w3-center w3-padding-32 w3-hide-small"> 
      <h1 class="w3-xxxlarge w3-text-blue w3-wide w3-allerta  glow  " style="text-shadow:1px 1px 0 #444" ><u>
      
         Welcome To My Blog
      
</u></h1>
      
    </div>
    <div class="w3-content w3-center">
    <div class="w3-bar w3-light-grey w3-border">
    <a href="/" class="w3-bar-item w3-button w3-large w3-green"><i class="fa fa-home"></i></a>
    
      <a href="/linhap/about-me" class="w3-bar-item w3-button w3-hide-small">About Me</a>
    
      <a href="/posts/" class="w3-bar-item w3-button w3-hide-small">Post</a>
    
   
    
    <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="displaymenu()">&#9776;</a>
  </div>

<div id="mobilemenu" class="w3-bar-block w3-light-grey w3-hide w3-hide-large w3-hide-medium">
  
      <a href="/linhap/about-me" class="w3-bar-item w3-button">About Me</a>
      
      <a href="/posts/" class="w3-bar-item w3-button">Post</a>
      
  
</div>
</div>
</div>
<script>
function displaymenu() {
    var x = document.getElementById("mobilemenu");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else { 
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>



  <div id="searchOverlay" class="overlay w3-hide">
    <span class="closebtn" onclick="displaysearch()" title="Close Overlay">×</span>
    <div class="overlay-content">
        <form action="/search/">
          <input type="text" placeholder="Search.." name="q">
          <button type="submit"><i class="fa fa-search"></i></button>
        </form>
    </div>
  </div>

  <script>
  function displaysearch() {
    var x = document.getElementById("searchOverlay");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else { 
        x.className = x.className.replace(" w3-show", "");
    }
      
  }

 
  </script>

  


    
    <hr class="headfoot">
   
      
    </header>
    
<div class="w3-content">
    
      <div>
        
        <div id="content" >
          
    <div class="w3-container w3-card-4">
      <h1 id="những-thứ-cần-biết-về-hashmap">Những thứ cần biết về hashmap</h1>
<p><img src="https://i.stack.imgur.com/sRa6z.png" alt="Thanks to Unsplash"></p>
<p>Hôm nay là một ngày cuối tuần không phải OT, cũng giống như nhưng buổi tuần trước đó thường sẽ ngủ một giấc
tới lúc hoàng hôn mới dậy(đấy là mình nghĩ thế thôi). Chả là hôm trước ở công ty thấy các bạn tts ở công ty mình đang được anh Lead đứng lớp java core đang học đến phần Collections: List, Vector, LinkedList, Set&hellip; có phần riêng biệt đó là Map trong java. Nhắc đến cái này tự nhiên lại nhớ đến 1 thời dữ dội tập tành tìm hiểủ về cái HashMap, HashTable&hellip;</p>
<p>Mình sẽ viết ra đây 1 chút kiến thức về Map trong ngôn ngữ Java mà ngày đó mình tìm hiểu được cái đầu tiên là HashMap đi cho dễ hiểu. Nếu đã sử dụng java chắc hẳn các bạn đã nghe đâu đó việc search các phần tử trong danh sách nếu được lưu trữ trong HashMap có thể là O(1) điều này có chính xác không nếu chính xác thì
tại sao lại như thế? Do thuật toán hay do structure của nó là key-value nên search nhanh? Why?</p>
<p>Câu trả lời là có thể là O(1) nhưng không phải lúc nào cũng là O(1), O(1) trong trường hợp key-value đó được save ngay đầu tiên của Node. Trước hết chúng ta cần phần biết rằng nếu có 1 list các phân tử được lưu trong List thông thường và để tìm 1 element trong list đó có thể chúng ta phải duyệt hết list mới tìm được(Nếu element này ở cuối). Lúc này độ phức tạp thuật toán là O(n). Giả sử có 1 resource có data khoảng 5tr sinh viên nếu lưu 5tr sinh viên này trong list có thể sẽ phải duyệt đến sv thứ 5tr để tìm được 1 sinh viên cần search trong đấy.</p>
<p>Không giống như ArrayList, Vector&hellip; HashMap có structure hoàn toàn khác. Đầu tiên nó lưu trữ theo Key-value(Cái này chắc hẳn ai cũng biết). Vậy thì key-value của nó được lưu như thế nào? Nó sẽ sử dụng array và cấu trúc của array này tương tự như cấu trúc trữ data của LinkedList cụ thể như sau:</p>
<p><img src="https://static.javatpoint.com/images/core/working-of-hashmap-in-java.png" alt="Thanks to Unsplash"></p>
<p>Có thể hiểu đơn giản là bên trong HashMap gồm 1 array có type là Node(Node&lt;K,V&gt;[] table). Giả sử ta put data
có key: &ldquo;1&rdquo;, value:&ldquo;abc&rdquo;. Lúc này key:&ldquo;1&rdquo; sẽ được qua hàm hashCode để lâý được giá trị tương ứng với key
này giả sử hashCode của 1 lúc này là: 2657860. Lúc này data được  lưu trong Node như sau: Node(2657860, &ldquo;1&rdquo;, &ldquo;abc&rdquo;, next). Đầu tiên là save giá trị sau khi hashCode, key, value và reference tới phần tử tiếp theo. Ủa cái này cũng lưu trữ trong mảng lại còn mất thêm bước hashcode nhanh hơn quần què nào được(Lúc mới tìm hiểu mình cũng nghĩ thế).</p>
<p>HashMap gồm 1 array[] có Type là Node như mình đã nói ở trên. Trong array này sẽ init 16 Node(Capacity) chưa chứa data Khi put key-value vào data sẽ được phân bố đều cho các Node trong array này. Lấy lại ví dụ  ở trên nhé 5tr sinh viên thay vì save trong 1 List lúc này sẽ được chia làm 5 như vậy là mỗi List
lúc này save khoảng 312,5K sinh viên lúc này thay vì search trong tệp 5tr kia thì ta chỉ việc tìm 1 trong
5 List kia đúng không nào. Nhưng làm thế nào để xác được element cần tìm lưu trong List nào(1,2,3,4,5) ?
đó là nguyên nhân mà tại sao khi put key-value thì key của phải qua hàm hashCode để lấy giá trị hash.</p>
<p>Giả sử hash key:&ldquo;1&rdquo; có hash là: 2657860. Java dựa vào giá trị này để tìm được index (trong khoảng 0-15)
để save data. Thế thì tính index bằng cách naò nhỉ? Index sẽ được tính theo công thức sau đây:</p>
<pre tabindex="0"><code>Index = hashcode(Key) &amp; (n-1)                                                                       
</code></pre><ul>
<li>Trong đó hashCode(Key) là giá trị sau khi hashCode n là length của array(như đã đề cập ở trên mặc định  là 16).</li>
<li>&amp; là toán tử thao tác bit(Bitwist Operators).</li>
<li>Index = 2657860 &amp; (16-1) = 4</li>
</ul>
<p>Lúc này Index=4 sẽ được save và Node thứ 4 trong array. Ví dụ cụ thể hơn là lưu save thông tin của 1 sinh viên Student(&ldquo;Aman&rdquo;,19) với Key:Aman, Value:19. Hình dưới mô tả nơi lưu và cách lưu của HashMap:</p>
<p><img src="https://static.javatpoint.com/images/core/working-of-hashmap-in-java3.png" alt="Thanks to Unsplash"></p>
<p>Như vậy là giả sử khi ta tìm kiếm 1 sinh viên trong tệp 5tr sinh viên sử dụng HashMap để lưu trữ. Lúc này
tệp data đã được chia nhỏ cho 5 nên chắc chắn việc tìm sẽ nhanh hơn do không phải duyệt toàn bộ sinh viên.
Nhưng trên đời này có 1 điều chắc chắn là &ldquo;Không có gì chắc chắn cả&rdquo; nếu 5tr sinh viên rơi vào TH toàn bộ save vào cùng 1 Node thì vẫn phải duyệt 5tr sv lúc này vẫn là O(n) trường hợp 0(1) sẽ rơi vào sinh viên đó
ở ngay đầu tiên của Node luôn(ăn ngay). Theo những gì mình biết thì trung bình HashMap tìm kiếm với độ phức tạp là O(log(n)). Như vậy tổng quan lại việc tìm kiếm nhanh hơn là do structure cũng như việc phân bố đều các element khi put vào HashMap.</p>
<p>Có 2 yếu tố chính ảnh hưởng đến perfomance của HashMap đó là Capacity và Load Factor. Capacity chắc hẳn các bạn đã hình dung nó là cái gì rồi đúng không  như ở trên mình đã nói mặc đinh khi init HashMap mà không truyền tham số cấu hình gì thêm vào Constructor của nó thì mặc định là 16. Load Factor hay được gọi
là hệ số tải nếu vượt quá ngưỡng 0.75 thì lúc này capacity sẽ tăng lên x2 là 32 để phục vụ cho việc phân bổ
đều hơn tránh bị save nhiều element trên cùng 1 Node giúp cho việc tìm kiếm nhanh hơn.</p>
<pre tabindex="0"><code>        Map&lt;String, String&gt; hash = new HashMap&lt;&gt;();
</code></pre><p>Sau khi Put element thứ 12 vào HashMap(0,75*16) thì lúc này HashMap sẽ tự động x2 length của array(16-&gt;32).
Chúng ta hoàn toàn có thể config được Capacity và Load Factor theo tuỳ chỉnh của mình. Nhưng đến đây các bạn có thắc mắc không tại sao Load Factor là 0,75 mà không phải là số khác. Chắc chắn sẽ có liên quan toán học và 1 yếu tố khác nữa. Mình sẽ viết ở bài viết tiếp theo.</p>

    </div>
        </div>
        
          <script>
  shareurl=encodeURIComponent(location.protocol + '//' + location.host + location.pathname);
  sharetitle=encodeURIComponent(document.title);
    
  </script>
<div class="icon-bar">
<script>
document.write( '<a href="javascript:bookmark();" class="bookmark w3-tooltip"><i class="fa fa-bookmark"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green ">Bookmark this page</span></a> ');

document.write( '<a href="http://www.facebook.com/sharer.php?u='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="facebook w3-tooltip"><i class="fa fa-facebook "></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Facebook</span></a> ');

document.write( '<a href="https://twitter.com/share?url='+shareurl+'&amp;text='+sharetitle+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="twitter w3-tooltip"><i class="fa fa-twitter"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Twitter</span></a> ');
document.write( '<a href="https://plus.google.com/share?url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="google w3-tooltip"><i class="fa fa-google"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Google Plus</span></a>');

document.write( '<a href="http://www.linkedin.com/shareArticle?mini=true&amp;url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="linkedin w3-tooltip"><i class="fa fa-linkedin"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Linkedin</span></a>');

</script>

<script>
function bookmark(){

if ('sidebar' in window && 'addPanel' in window.sidebar) { 
                window.sidebar.addPanel(location.href,document.title,"");
            } else if(  false) { 
                window.external.AddFavorite(location.href,document.title); 
            } else { 
                alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != - 1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
            }
        }

</script>
</div>
        
           
          
  

        
        
      </div>
    

   
    <footer id="footer" >
      <div class="w3-container w3-center w3-padding-32"> 
  
  <hr class="headfoot">
  <p>Powered by <a href="https://gohugo.io">LinhAp</a> | Theme - <a href="https://linhdev.github.io/">LinhAp</a>
  </p>
  © <a href="https://linhdev.github.io/">LinhAp</a> 2021 | <a href="https://linhdev.github.io/">Github</a>
  
</div>

    </footer>
    

    
  </div>

   
  <div id="cookiebar" class="w3-bar w3-top w3-black w3-border   " >
  
  <span class="w3-bar-item w3-small">This website uses cookies to ensure you get the best experience on our website. <a href="/privacy-policy/">Learn more</a></span>
  <span onclick="gotitcookiebar()"
  class="w3-button w3-small w3-green w3-right">Got it</span>
   </div>

    
<script>
function gotitcookiebar() {
    var x =document.getElementById("cookiebar");
    x.style.display = "none";
var x = document.getElementsByTagName("BODY")[0];
    x.style.paddingTop = "0px";
    

}


    
function checkCookie() {
    var user=getCookie("cookiebardisplayed");
    if (user == "") {
      setCookie("cookiebardisplayed","0",365);}

    user=getCookie("cookiebardisplayed");
    if (user =="0")
    {

        var x =document.getElementById("cookiebar");
    x.style.display = "block";
    var h = document.getElementById('cookiebar').clientHeight;
    
    var x = document.getElementsByTagName("BODY")[0];
    x.style.paddingTop = h+"px";
    setCookie("cookiebardisplayed","1",365);
    } 
    
}
function setCookie(cname,cvalue,exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires=" + d.toGMTString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}
document.addEventListener('DOMContentLoaded', function() {
    checkCookie();
}, false);

</script>   


  
    
      <div id="backtotop" class="w3-hide-small w3-hide-medium">
  
        <button onclick="topFunction()" class="w3-btn w3-red w3-large" style="width:160px">Back To Top
        &rarr;</button>
        
      </div>

      <script>
        function topFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
      }
      </script>


    
 
    
    <script>
    
    function isVisible(elem) {

      let coords = elem.getBoundingClientRect();

      let windowHeight = document.documentElement.clientHeight;

      
      let topVisible = coords.top > 0 && coords.top < windowHeight;
      let bottomVisible = coords.bottom < windowHeight && coords.bottom > 0;

      return topVisible || bottomVisible;
    }

    

    function showVisible() {
      for (let img of document.querySelectorAll('img')) {
        let realSrc = img.dataset.src;
        if (!realSrc) continue;

        if (isVisible(img)) {
          

          img.src = realSrc;

          img.dataset.src = '';
        }
      }
      if ( Array.from(document.querySelectorAll('[data-src]')).every(
        img => img.getAttribute('data-src') === '') ) {
        window.removeEventListener('scroll', showVisible)
      }

    }

    window.addEventListener('scroll', showVisible);
    showVisible();
  </script>


    
    
      <div class="progress-container" id="scrollbar">
        <div class="progress-bar" id="progress-bar"></div>
      </div>  


    
<script>

window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  <!-- TOC -->
    
    
    
    <!-- cookie bar -->
    
    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
        var x =document.getElementById("cookiebar");
        x.style.display = "none";
        var x = document.getElementsByTagName("BODY")[0];
        x.style.paddingTop = "0px";

    } 
    
<!-- Back to top -->
    
    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
        document.getElementById("backtotop").style.display = "block";
    } else {
        document.getElementById("backtotop").style.display = "none";
    }
    
    <!-- scroll indicator -->
    
      var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      var scrolled = (winScroll / height) * 100;
      document.getElementById("progress-bar").style.width = scrolled + "%";
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("scrollbar").style.display = "block";
        } else {
            document.getElementById("scrollbar").style.display = "none";
        }
    

    

    <!-- allowads -->
    
       if (document.body.scrollTop > 2000 || document.documentElement.scrollTop > 2000) {
          detectads();
       } 

    
}


</script>



  

</body>
</html>
